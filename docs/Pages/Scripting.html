<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>















    <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.6), see www.w3.org"><title>Simbrain Documentation</title>
    





    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <link href="../Styles.css" rel="stylesheet" type="text/css"></head><body>
    <a href="../SimbrainDocs.html"></a>
    <div class="logo"></div>
    <div id="main_docs">
        <div class="navi">
            <p><a href="../SimbrainDocs.html">Simbrain</a> &gt; Scripting</p>
        </div>
        <h1>Scripting</h1>
        <br>
        <p>To produce custom simulations or behaviors not possible using the Simbrain GUI, you can create custom scripts.</p>
        <p>All scripts are currently <a href="http://www.beanshell.org/docs.html">beanshell</a>
scripts (there is nothing to prevent other scripting languages, but
none have been implemented yet).&nbsp;&nbsp; These are basically small
java programs that interact with the Simbrain workspace.&nbsp;&nbsp;
Any java library can be used, as can the whole Simbrain API.&nbsp; This
allows for a great deal of flexibility.</p>
        <p>Some examples of things you can do using scripts are:</p>
        <ul>
            <li>Building a highly customized simulation.
                <br>
            </li>
            <li>Create a custom button panel that allows users to produce special behaviors.
                <br>
            </li>
            <li>Modifying an existing component, e.g. a network, in some special way.
                <br>
            </li>
            <li>Logging data.</li>
            <li>Loading a neuron with a custom update function.</li>
            <li>Using an external library. The script called "GeneticAlgorithmScriptingDemo.bsh" gives an example of this.
                <br>
            </li>
        </ul>
        <p>The
best way to get a feel for scripting is to have a look at a few
scripts.&nbsp;&nbsp; Try opening a few in the scriptmenu directory, and
running them. &nbsp; Try modifying them in simple ways (e.g. modifying
the paramters at the top) and re-running them.&nbsp; <br>
        </p>
        <p>Scripting is closely
related to custom updating in Simbrain. Custom update methods for the
workspace or for components introduce custom update actions that are
written using this same Beanshell scripting framework.&nbsp; See <a href="./Workspace/Update.html">workspace update</a> and <a href="./Network/update.html">network update</a>.
            <br>
        </p>
        <p>
            <span class="heading">The Basics of Beanshell Scripting
            </span>
            <br>
        </p>
        <p>Beanshell
is basically java in a form that can be executed dynamically.&nbsp; So
rather than writing and compiling java source code, you can simply
write it and run it immediately. Since it is basically java, to use
Beasnhell requires that you know java.&nbsp;&nbsp; But many tasks are
fairly routine and you can make them happen by modifing existing code
(see the examples below).</p>
        <p>The first thing you will often
do in a script is to either (1) create objects and add them to the
workspace, or (2) get access to objects already in the workspace.
Objects could be networks, neurons, neuron groups, synapses, synpase
groups, agents in worlds, plot components, or other
components.&nbsp;&nbsp; Once you have these objects you can do various
things with them. <br>
        </p>
        <p>By default, beanshell scripts have access to two objects:</p>
        <p style="margin-left: 40px;">
            <span style="text-decoration: underline;">workspace</span>:
the underlying logical representation of all components in
Simbrain.&nbsp;&nbsp; You can add new components to the workspace, or
get components and then modify them. This is the main point of access
to Simbrain. <br>
        </p>
        <p style="margin-left: 40px;">
            <span style="text-decoration: underline;">desktop</span>:
the graphical object which displays a workspace.&nbsp; In scripts this
is mostly used to specify where components are, or how large they are. <br>
        </p>
        <p>For example, to add a neuron
to a neural network component named "Network1" in Simbrain, you can
create the neuron then add it to Network1:</p>
        <p style="margin-left: 40px;" class="command">&nbsp;&nbsp;&nbsp; Network network =&nbsp; workspace.getComponent("Network 1").getNetwork();
            <br>&nbsp;&nbsp;&nbsp; Neuron neuron1 = new Neuron(network, "LinearRule");
            <br>&nbsp;&nbsp;&nbsp; neuron1.setLocation(2,2);
            <br>&nbsp;&nbsp;&nbsp; network.addNeuron(neuron1);</p>
        <p>To
take full advantage of Simbrain, you will need to be familiar with the
Simbrain source code, which has a great number of facilities for
creating neural networks, connecting neurons together, laying them out,
etc.&nbsp;&nbsp; The source if fairly well documented.&nbsp;&nbsp;
See{SimbrainHome}/src </p>
        <p>
            <span class="heading">How to Invoke a script
                <br>
            </span>
        </p>
        <p>To
get started, create a new text file with a text editor, save it as a
.bsh file, and then run the script from Simbrain.&nbsp; There are a few
ways to do this: <br>
            <br>
            <br>
        </p>
        <div style="margin-left: 40px;">
            <span class="heading2">Scriptmenu</span>: .bsh files in the {SimbrainHome}/scripts/scriptmenu directory automatically appear in the&nbsp;
            <span class="command">Scripts</span>menu
of the Simbrain workspace (if you just added the file, you must re-run
simbrain).&nbsp;&nbsp; You can also use the the&nbsp; <span class="command">Scripts &gt; Edit/Run Script...</span>command to open, edit, then run a script. e.g. one in a location other than the scripts directory.
            <br>
            <br>
            <span class="heading2">Network</span>: .bsh files in {SimbrainHome}/scripts/network&nbsp; automatically appear in the
            <span class="command">Scripts</span>menu
of Simbrain network components&nbsp;&nbsp; Use this directory to create
custom actions that can be applied to a current network (e.g., methods
of adding neurons, modifying neurons or synapses, etc.)&nbsp; The two
objects available here are " <span style="text-decoration: underline;">network</span>" and "
            <span style="text-decoration: underline;">networkPanel</span>."&nbsp; These give access to the current Network and its gui representation.
            <br>
            <br>
            <span class="heading2">Console</span>:
.bsh files in {SimbrainHome}/scripts/console are available from the
Simbrain console or terminal components. The console can be useful to
quickly test or debug Simbrain. For a sense of some things you can do
in the console enter "help(); or "tips();". The console is similar to a
UNIX or DOS terminal window.&nbsp; You can navigate around the file
system using commands like "cd();&nbsp; To run a script from the
console, using the source command, e.g.&nbsp; <span class="command">source("sparseNetwork.bsh");&nbsp;</span>
        </div>
        <p>
            <span class="heading">
                <br>
            </span>
        </p>
        <br>
        <p style="text-align: left;">
            <span style="font-weight: bold;">Coordinating Workspace Zip Files and Scripts
            </span>
            <span style="font-weight: bold;">
                <br>
            </span>
        </p>
        <p>Sometimes
it&nbsp; is useful to create a script that modifies the behavior of a
workspace file (a .zip file).&nbsp;&nbsp; That way the script takes
care of the custom behavior, and the workspace file can be
incrementally modified using Simbrain's point and click methods.&nbsp;
Examples are the actor-critic&nbsp; and Rescorla Wagner
scripts.&nbsp;&nbsp; To edit the workspace in such a case, just run the
script, change the workspace, and then save the workspace. <br>
        </p>
        <p>
            <span class="heading">TroubleShooting</span>
        </p>
        <p>Often scripts won't work at first.&nbsp; To get feedback on errors that occur run Simbrain from a terminal, using this command
        </p>
        <p class="command" style="margin-left: 40px;">java -jar Simbrain.jar
            <br>
        </p>
        <p>Note that in beanshell you cannot use 2d arrays or generics.</p>
        <p>
            <span class="heading">Example: Bar Chart
                <br>
            </span>
        </p>
        <p>To get a very basic feel for scripting, go to
            <span class="command">Scripts &gt; Edit/Run Script</span>and,
load BarChartDemo.bsh, and try modifying the parameters at the top,
before running the simulation.&nbsp; Try this a few times to see how
the parameters affect the simulation. <br>
        </p>
        <p>
            <span class="heading">Example: Creating a simple network from scratch
                <br>
            </span>
        </p>
        <p>Here
is an example of a simple script to create a few neurons connected by a
synapse.&nbsp;&nbsp; You can use this example to get a feel for
creating a script from scratch. <br>
        </p>
        <p>To start, open a text file,
copy and paste the text below, and save it as a .bsh file (for example,
"SimpleNet.bsh"). Then execute the script, either using <span class="command">Scripts &gt; Edit/Run Script...
            </span>or by placing it in the {SimbrainHome}/scripts/scriptmenu directory and re-running Simbrain.
        </p>


        <p style="margin-left: 40px;" class="command">import org.simbrain.network.*;
            <br>import org.simbrain.network.core.*;
            <br>import org.simbrain.network.networks.*;
            <br>import org.simbrain.network.neuron_update_rules.*;
            <br>import org.simbrain.workspace.*;
            <br>
            <br>{
            <br>&nbsp;&nbsp;&nbsp; NetworkComponent networkComponent = new NetworkComponent("Test Network");
            <br>&nbsp;&nbsp;&nbsp; workspace.addWorkspaceComponent(networkComponent);
            <br>&nbsp;&nbsp;&nbsp; Network network = networkComponent.getNetwork();
            <br>
            <br>&nbsp;&nbsp;&nbsp; Neuron neuron1 = new Neuron(network, "LinearRule");
            <br>&nbsp;&nbsp;&nbsp; neuron1.setLocation(2,2);
            <br>&nbsp;&nbsp;&nbsp; network.addNeuron(neuron1);
            <br>
            <br>&nbsp;&nbsp;&nbsp; Neuron neuron2 = new Neuron(network, "LinearRule");
            <br>&nbsp;&nbsp;&nbsp; neuron2.setLocation(50,2);
            <br>&nbsp;&nbsp;&nbsp; network.addNeuron(neuron2);
            <br>
            <br>&nbsp;&nbsp;&nbsp; network.addSynapse(new Synapse(neuron1, neuron2));
            <br>
            <br>}
        </p>
        <p>
            <span class="heading">Example: Logging hidden unit activations
                <br>
            </span>
        </p>
        <p>To
do this, you must create a custom update action.&nbsp;&nbsp; First
create a network and add a Backprop subnetwork to it.&nbsp; Then go to&nbsp;<span class="command">File &gt; Edit&nbsp; Update Sequence...</span>.&nbsp; Then click the "add custom
action" button.&nbsp; Then&nbsp; copy and paste the code below in to the editor:<br>
</p>
        <p class="command" style="margin-left: 40px;">
            <br>import org.simbrain.network.core.*;
            <br>import org.simbrain.network.subnetworks.*;
            <br>import org.simbrain.network.groups.*;
            <br>import org.simbrain.network.update_actions.*;
            <br>
            <br>/**
            <br>&nbsp;* Log data from hidden units.
            <br>&nbsp;*/
            <br>{
            <br>&nbsp;&nbsp;&nbsp; // Object used for standard update.
            <br>&nbsp;&nbsp;&nbsp; BufferedUpdate bufferedUpdate = new BufferedUpdate(network);
            <br>
            <br>&nbsp;&nbsp;&nbsp; // Customize this
            <br>&nbsp;&nbsp;&nbsp; this.action = new NetworkUpdateAction() {
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public void invoke() {
            <br>
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // Log hidden unit activations
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BackpropNetwork backpropNet = network.getGroupByLabel("Backprop");
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; NeuronGroup hiddenLayer = backpropNet.getNeuronGroupByLabel("Layer 2");
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; for (Neuron neuron: hiddenLayer.getNeuronList()) {
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.print(neuron.getActivation() + " ");
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; }
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; System.out.println();
            <br>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // This is how the action appears in the update manager dialog
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public String getDescription() {
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return "Print hidden unit activations";
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // This is a longer description for the tooltip
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public String getLongDescription() {
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return "Print hidden unit activations";
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }
            <br>
            <br>&nbsp;&nbsp;&nbsp; };
            <br>}
            <br>
            <br>
        </p>
        <p>After this, when you run the network it will print out the activations of the hidden units.</p>
        <p>
            <span class="heading">Example: Custom update of a neuron
                <br>
            </span>
        </p>
        <p>This
is another example of using a custom update script, this time to do
something custom to the neural activations in a network.&nbsp; Use the
same script as above, but change the block under "Log Hidden Unit
Activations" to this:</p>



        <p style="margin-left: 40px;" class="command">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; // Randomize hidden unit activations
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; BackpropNetwork backpropNet = network.getGroupByLabel("Backprop");
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; NeuronGroup inputLayer = backpropNet.getNeuronGroupByLabel("Layer 1");
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; for (Neuron neuron: inputLayer.getNeuronList()) {
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; neuron.forceSetActivation(Math.random());
            <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; }
            <br>
        </p>



        <p>You should also change the getDescription() and getLongDescription() methods.
        </p>
        <p>This
will result in the activations of the input neurons being randomized at
every iteration.&nbsp; Changes like this can be used to customize
network update in various ways. <br>
        </p>
    </div>
</body></html>